policies:
- name: stop-unused-vms
  description: Stop VMs that have not been used in the last x days and have an average
    CPU below the set threshold, and have a specific tag(optional)
  resource: azure.vm
  enabled: false
  filters:
  - type: last_used
    days: 30
    threshold: 10
  actions:
  - type: stop
- name: delete-unused-disks
  description: Delete disks that are not attached to any VMs
  resource: azure.disk
  enabled: false
  filters:
  - type: unattached
  actions:
  - type: delete
- name: delete-unattached-public-ips
  description: Delete unattached public IPs
  resource: azure.publicip
  enabled: true
  filters:
  - type: unattached
  actions:
  - type: delete
- name: delete-resources-in-group
  description: Delete all resources in a resource group if the group contains the
    tag kill:dev
  resource: azure.resourcegroup
  enabled: true
  exclusions:
  - type: tag
    key: exclude
    value: 'true'
  filters:
  - type: tag
    key: kill
    value: dev
  actions:
  - type: delete
- name: update-storage-account-sku
  description: Update Storage Account SKU to Standard_LRS for specific SKUs and tags
  resource: azure.storage
  enabled: true
  filters:
  - type: sku
    values:
    - Standard_GRS
    - Standard_RAGRS
    - Standard_ZRS
    - Standard_GZRS
  actions:
  - type: update_sku
    sku: Standard_LRS
- name: delete-empty-backend-pool-app-gateways
  description: Delete empty backend pool App Gateways with a specific tag
  resource: azure.applicationgateway
  enabled: true
  filters:
  - type: tag
    key: Environment
    value: dev
  actions:
  - type: delete
- name: scale-sql-database-dtu
  description: Scale SQL databases during off-peak hours
  resource: azure.sql
  enabled: true
  filters:
  - type: tag
    key: environment
    value: dev
  actions:
  - type: scale_dtu
    tiers:
    - name: Basic
      min_dtu: 5
      max_dtu: 5
      off_peak_dtu: 5
      peak_dtu: 5
    - name: Standard
      min_dtu: 10
      max_dtu: 100
      off_peak_dtu: 10
      peak_dtu: 20
    - name: Premium
      min_dtu: 25
      max_dtu: 1000
      off_peak_dtu: 25
      peak_dtu: 1000
- name: delete-unattached-nics
  description: Delete unattached NICs
  resource: azure.nic
  enabled: true
  filters:
  - type: unattached
  actions:
  - type: delete
- name: downgrade-disks-of-stopped-vms
  description: Downgrade disks of stopped VMs
  resource: azure.vm
  enabled: true
  filters:
  - type: stopped
  actions:
  - type: downgrade_disks
